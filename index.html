<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="demers.github.io : Présentations" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>demers.github.io</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/demers">View on GitHub</a>

          <h1 id="project_title">demers.github.io</h1>
          <h2 id="project_tagline">Présentations</h2>

        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a name="scripting-language-for-android-sl4a" class="anchor" href="#scripting-language-for-android-sl4a"><span class="octicon octicon-link"></span></a>Scripting Language for Android (SL4A)</h1>

<p><img src="http://code.google.com/p/android-scripting/logo?cct=1380444037" alt="SL4A"></p>

<p>Site officiel: <a href="http://code.google.com/p/android-scripting/">http://code.google.com/p/android-scripting/</a></p>

<h2>
<a name="quelques-informations-sur-moi" class="anchor" href="#quelques-informations-sur-moi"><span class="octicon octicon-link"></span></a>Quelques informations sur moi</h2>

<ul>
<li>Je suis informaticien.</li>
<li>Je suis enseignant au Cégep depuis 2000.</li>
<li>Je travaille au Cégep de Sainte-Foy depuis 2007.</li>
<li>Je m'intéresse aux logiciels libres et Linux depuis 2000.</li>
<li>Je m'intéresse à Android (pour mon cours de Cégep) depuis 2012.</li>
</ul><h2>
<a name="pourquoi-sl4a" class="anchor" href="#pourquoi-sl4a"><span class="octicon octicon-link"></span></a>Pourquoi SL4A?</h2>

<ul>
<li>Mes étudiants ne connaissaient pas le langage de base de Android: Java</li>
<li>Il fallait un langage alternatif</li>
<li>
<strong>Python</strong> est un langage simple, pédagogique, puissant et non-typé.</li>
</ul><h2>
<a name="suppositions-pour-la-suite" class="anchor" href="#suppositions-pour-la-suite"><span class="octicon octicon-link"></span></a>Suppositions pour la suite</h2>

<ul>
<li>Vous avez une installation Linux sur votre ordinateur (sinon, on va faire avec!)</li>
<li>Vous avez <strong>Python 2.7</strong> d'installé dans votre système (par défaut).</li>
</ul><h2>
<a name="informations-g%C3%A9n%C3%A9rales-sur-android" class="anchor" href="#informations-g%C3%A9n%C3%A9rales-sur-android"><span class="octicon octicon-link"></span></a>Informations générales sur Android</h2>

<p>Présentation Slideshare: <a href="http://fr.slideshare.net/ranjith2011/introduction-to-android-7872075">http://fr.slideshare.net/ranjith2011/introduction-to-android-7872075</a></p>

<h2>
<a name="%C3%89tapes-dinstallation" class="anchor" href="#%C3%89tapes-dinstallation"><span class="octicon octicon-link"></span></a>Étapes d'installation</h2>

<p>J'ai 2 clés USB pour réduire le temps de téléchargement.</p>

<h3>
<a name="%C3%89tape-1-installer-le-sdk-de-android" class="anchor" href="#%C3%89tape-1-installer-le-sdk-de-android"><span class="octicon octicon-link"></span></a>Étape 1: Installer le SDK de Android</h3>

<ol>
<li>Téléchargez le SDK à <a href="http://developer.android.com/sdk/">http://developer.android.com/sdk/</a>
</li>
<li>Décompressez le fichier dans le dossier /tmp</li>
<li>Rendez-vous dans le dossier créé et déplacez le dossier "sdk" dans votre compte utilisateur.</li>
<li>Faites de même pour le dossier "eclipse" dans votre compte utilisateur.</li>
<li>Configurez votre variable $PATH dans votre fichier ~/.bashrc en ajoutant cette ligne
<code>
export PATH=~/sdk/platform-tools/:$PATH
</code>
</li>
<li>Fermez votre console et ouvrez-en une autre.</li>
<li>Tapez la commande pour savoir si le changement a fonctionné:</li>
</ol><div class="highlight highlight-bash"><pre>adb devices
</pre></div>

<h3>
<a name="%C3%89tape-2-installer-eclipse-et-le-plugin-android" class="anchor" href="#%C3%89tape-2-installer-eclipse-et-le-plugin-android"><span class="octicon octicon-link"></span></a>Étape 2: Installer Eclipse et le plugin Android</h3>

<ul>
<li>Installez Open Java en cherchant apt://openjdk-7-jdk</li>
<li>Si vous avez des problèmes, vous pouvez installer SDK de Oracle par les commandes suivantes:</li>
</ul><pre><code>   sudo add-apt-repository ppa:webupd8team/java
   sudo apt-get update
   sudo apt-get install oracle-java7-installer
</code></pre>

<ul>
<li>Précédemment, vous avez installé Eclipse dans votre compte dans le dossier ~/eclipse</li>
<li>Partez Eclipse par la commande ~/eclipse/eclipse</li>
<li>Dans le menu <em>Window/Preference/Android</em>, vérifiez la présence du chemin d'accès dans le SDK location qui doit être le répertoire vers android-sdk (normalement le chemin <strong>~/sdk</strong>)</li>
<li>Normalement, dans le menu Window, il devrait y avoir l'option Android SDK Manager.</li>
<li>Choisissez cette option et cochez Android 4.3 (API 18) et Android 4.0.3 (API 15).</li>
<li>Vérifiez que pour Android 4.0.3 API 15, vous avez coché les <em>Sources for Android SDK</em>. </li>
<li>L'installation peut prendre du temps.</li>
<li>Sous Eclipse, allez copier le chemin d'accès dans le menu <em>Window/Preferences/Android/SDK Location</em> Dans le menu <em>Window/Preferences/Java/Build Path/Classpath</em>, ajoutez une variable appelé <em>ANDROID</em>SDK_ et entrez le chemin d'accès précédent (coller). Ajoutez-y le chemin <em>/sources/android-15</em> pour que ça donne comme suit (ou l'équivalent): 
<code>
~/sdk/sources/android-15/
</code>
</li>
</ul><h3>
<a name="%C3%89tape-3-installer-le-plugin-pour-programmer-en-python" class="anchor" href="#%C3%89tape-3-installer-le-plugin-pour-programmer-en-python"><span class="octicon octicon-link"></span></a>Étape 3: Installer le plugin pour programmer en Python.</h3>

<ol>
<li>Partez Eclipse.</li>
<li>Dans le menu Help et l'option Install New Software, et le bouton New, tapez l'URL:
<code>
http://pydev.org/updates
</code>
</li>
<li>Complétez l'installation du plugin en cochant PyDev.</li>
<li>Ouvrir le menu 'Window' et 'Preferences'.</li>
<li>Choisir l'option 'PyDev' et 'Interpreter - Python'.</li>
<li>Cliquer 'New' pour ajouter un interpréteur Python qui se trouve à /usr/bin/python</li>
<li>Si l'étape de la puce (2) ne fonctionne pas, vous pouvez suivre les étapes suivantes.

<ol>
<li>Téléchargez PyDev à <a href="http://sourceforge.net/projects/pydev/files/">http://sourceforge.net/projects/pydev/files/</a>
</li>
<li>Décompressez le fichier ZIP dans le dossier ~/eclipse</li>
<li>Assurez-vous que Eclipse est fermé.</li>
<li>Déplacez le contenu du dossier <strong>plugins</strong> (au départ dans le dossier PyDev) dans le dossier <em>~/eclipse/plugins</em>
</li>
<li>Déplacez le contenu du dossier <strong>features</strong> (au départ dans le dossier PyDev) dans le dossier <em>~/eclipse/features</em>
</li>
<li>Partez Eclipse en ligne de commande comme suit: 
<code>
~/eclipse/eclipse -clean
</code>
</li>
<li>Pour en savoir plus, consultez <a href="http://pydev.org/manual_101_install.html">http://pydev.org/manual_101_install.html</a>
</li>
</ol>
</li>
</ol><h2>
<a name="%C3%89tape-4-d%C3%A9marrez-un-premier-%C3%A9mulateur" class="anchor" href="#%C3%89tape-4-d%C3%A9marrez-un-premier-%C3%A9mulateur"><span class="octicon octicon-link"></span></a>Étape 4: Démarrez un premier émulateur</h2>

<ol>
<li>Dans le menu Window/Android Virtual Device manager, faites New AVD</li>
<li>Choisissez les options voulues.</li>
<li>Démarrez l'émulateur.</li>
<li>Voir si l'émulateur est bien accessible en tapant
<code>
adb devices
</code>
</li>
</ol><h2>
<a name="%C3%89tape-5-cr%C3%A9er-un-projet-de-d%C3%A9veloppement-python-sous-eclipse" class="anchor" href="#%C3%89tape-5-cr%C3%A9er-un-projet-de-d%C3%A9veloppement-python-sous-eclipse"><span class="octicon octicon-link"></span></a>Étape 5: Créer un projet de développement Python sous Eclipse</h2>

<ul>
<li>Créez un nouveau projet PyDev.  Choisissez l'option de créer un dossier "src".</li>
<li>Par le clique-droit, créez un module PyDev 'Main' appelé <strong>launch_app.py</strong> avec le code suivant: </li>
</ul><div class="highlight highlight-python"><pre><span class="c">#!/usr/bin/env python</span>

<span class="sd">'''</span>
<span class="sd">@author: Pro Android Python with SL4A</span>
<span class="sd">'''</span>

<span class="kn">import</span> <span class="nn">subprocess</span>

<span class="n">ADB</span> <span class="o">=</span> <span class="s">r'C:\Program Files (x86)\Android\android-sdk\platform-tools\adb.exe'</span>
<span class="n">ADB</span> <span class="o">=</span> <span class="s">'/home/linux/android/android-sdks/platform-tools/adb'</span>
<span class="n">APPLICATION</span> <span class="o">=</span> <span class="s">'androidtest.py'</span>
<span class="n">TARGET</span> <span class="o">=</span> <span class="s">'/sdcard/sl4a/scripts/'</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="c"># Upload the application.   </span>
    <span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">([</span><span class="n">ADB</span><span class="p">,</span> <span class="s">'-e'</span><span class="p">,</span> <span class="s">'push'</span><span class="p">,</span> <span class="n">APPLICATION</span><span class="p">,</span> <span class="n">TARGET</span> <span class="o">+</span> <span class="n">APPLICATION</span><span class="p">])</span>

    <span class="c"># Launch the application.</span>
    <span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">([</span><span class="n">ADB</span><span class="p">,</span> <span class="s">'-e'</span><span class="p">,</span> <span class="s">'shell'</span><span class="p">,</span> <span class="s">'am'</span><span class="p">,</span> <span class="s">'start'</span><span class="p">,</span>
          <span class="s">'-a'</span><span class="p">,</span> <span class="s">'com.googlecode.android_scripting.action.LAUNCH_BACKGROUND_SCRIPT'</span><span class="p">,</span>
          <span class="s">'-n'</span><span class="p">,</span>
           <span class="s">'com.googlecode.android_scripting/.activity.ScriptingLayerServiceLauncher'</span><span class="p">,</span>
          <span class="s">'-e'</span><span class="p">,</span> <span class="s">'com.googlecode.android_scripting.extra.SCRIPT_PATH'</span><span class="p">,</span>
          <span class="n">TARGET</span> <span class="o">+</span> <span class="n">APPLICATION</span><span class="p">])</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>

<ul>
<li>Il faut reconfigurer les variables ADB (et aussi APPLICATION).</li>
<li>Créez un module 'Main' avec le code suivant: </li>
</ul><pre><code>import android
droid = android.Android()
droid.makeToast('Hello, Android!')
</code></pre>

<ul>
<li>Exécutez le script launch_app.py (Run PyDev). </li>
</ul><h2>
<a name="des-exemples-de-code" class="anchor" href="#des-exemples-de-code"><span class="octicon octicon-link"></span></a>Des exemples de code</h2>

<h3>
<a name="premier-exemple" class="anchor" href="#premier-exemple"><span class="octicon octicon-link"></span></a>Premier exemple</h3>

<div class="highlight highlight-python"><pre><span class="kn">import</span> <span class="nn">android</span>
<span class="n">droid</span> <span class="o">=</span> <span class="n">android</span><span class="o">.</span><span class="n">Android</span><span class="p">()</span>
<span class="n">name</span> <span class="o">=</span> <span class="n">droid</span><span class="o">.</span><span class="n">dialogGetInput</span><span class="p">(</span><span class="s">"Hello!"</span><span class="p">,</span> <span class="s">"What is your name?"</span><span class="p">)</span>
<span class="n">droid</span><span class="o">.</span><span class="n">makeToast</span><span class="p">(</span><span class="s">"Hello, </span><span class="si">%s</span><span class="s">"</span> <span class="o">%</span> <span class="n">name</span><span class="o">.</span><span class="n">result</span><span class="p">)</span>
</pre></div>

<h3>
<a name="deuxi%C3%A8me-exemple" class="anchor" href="#deuxi%C3%A8me-exemple"><span class="octicon octicon-link"></span></a>Deuxième exemple</h3>

<div class="highlight highlight-python"><pre><span class="sd">"""Speak the time."""</span>

<span class="n">__author__</span> <span class="o">=</span> <span class="s">'T.V. Raman &lt;raman@google.com&gt;'</span>
<span class="n">__copyright__</span> <span class="o">=</span> <span class="s">'Copyright (c) 2009, Google Inc.'</span>
<span class="n">__license__</span> <span class="o">=</span> <span class="s">'Apache License, Version 2.0'</span>

<span class="kn">import</span> <span class="nn">android</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">droid</span> <span class="o">=</span> <span class="n">android</span><span class="o">.</span><span class="n">Android</span><span class="p">()</span>
<span class="n">droid</span><span class="o">.</span><span class="n">ttsSpeak</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s">"%_I %M %p on %A, %B %_e, %Y "</span><span class="p">))</span>
</pre></div>

<h2>
<a name="troisi%C3%A8me-exemple" class="anchor" href="#troisi%C3%A8me-exemple"><span class="octicon octicon-link"></span></a>Troisième exemple</h2>

<pre><code>title = 'User Interface'
message = 'Welcome to the SL4A integration test.'
droid.dialogCreateAlert(title, message)
droid.dialogSetPositiveButtonText('Continue')
droid.dialogShow()
response = droid.dialogGetResponse().result
return response['which'] == 'positive'
</code></pre>

<p>D'autres exemples disponibles dans ce fichier ZIP: <a href="http://code.google.com/p/android-scripting/downloads/detail?name=python_scripts_r8.zip&amp;can=2">http://code.google.com/p/android-scripting/downloads/detail?name=python_scripts_r8.zip&amp;can=2</a></p>

<p>Consultez surtout le programme <strong>test.py</strong></p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
